{"version":3,"file":"useRowSelect.js","sources":["../../../src/table/hooks/useRowSelect.tsx"],"sourcesContent":["// 行选中相关功能：单选 + 多选\n\nimport React, { useEffect, useState, MouseEvent } from 'react';\nimport intersection from 'lodash/intersection';\nimport get from 'lodash/get';\nimport isFunction from 'lodash/isFunction';\nimport useControlled from '../../hooks/useControlled';\nimport {\n  PrimaryTableCellParams,\n  PrimaryTableCol,\n  RowClassNameParams,\n  TableRowData,\n  TdBaseTableProps,\n  TdPrimaryTableProps,\n} from '../type';\nimport { isRowSelectedDisabled } from '../utils';\nimport { TableClassName } from './useClassName';\nimport Checkbox from '../../checkbox';\nimport Radio from '../../radio';\nimport { ClassName } from '../../common';\nimport log from '../../_common/js/log';\n\nconst selectedRowDataMap = new Map<string | number, TableRowData>();\n\nexport default function useRowSelect(\n  props: TdPrimaryTableProps,\n  tableSelectedClasses: TableClassName['tableSelectedClasses'],\n) {\n  const { selectedRowKeys, columns, data, rowKey, indeterminateSelectedRowKeys } = props;\n  const [selectedRowClassNames, setSelectedRowClassNames] = useState<TdBaseTableProps['rowClassName']>();\n  const [tSelectedRowKeys, setTSelectedRowKeys] = useControlled(props, 'selectedRowKeys', props.onSelectChange, {\n    defaultSelectedRowKeys: props.defaultSelectedRowKeys || [],\n  });\n  const selectColumn = columns.find(({ type }) => ['multiple', 'single'].includes(type));\n  const canSelectedRows = data.filter((row, rowIndex): boolean => !isDisabled(row, rowIndex));\n  // 选中的行，和所有可以选择的行，交集，用于计算 isSelectedAll 和 isIndeterminate\n  const intersectionKeys = intersection(\n    tSelectedRowKeys,\n    canSelectedRows.map((t) => get(t, rowKey || 'id')),\n  );\n\n  useEffect(\n    () => {\n      if (!selectColumn && (!tSelectedRowKeys || !tSelectedRowKeys.length)) return;\n      const disabledRowFunc = (p: RowClassNameParams<TableRowData>): ClassName =>\n        selectColumn.disabled(p) ? tableSelectedClasses.disabled : '';\n      const disabledRowClass = selectColumn?.disabled ? disabledRowFunc : undefined;\n      const selected = new Set(tSelectedRowKeys);\n      const selectedRowClassFunc = ({ row }: RowClassNameParams<TableRowData>) => {\n        const rowId = get(row, rowKey || 'id');\n        return selected.has(rowId) ? tableSelectedClasses.selected : '';\n      };\n      const selectedRowClass = selected.size ? selectedRowClassFunc : undefined;\n      setSelectedRowClassNames([disabledRowClass, selectedRowClass]);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [data, columns, tSelectedRowKeys, selectColumn, rowKey],\n  );\n\n  function isDisabled(row: Record<string, any>, rowIndex: number): boolean {\n    return isRowSelectedDisabled(selectColumn, row, rowIndex);\n  }\n\n  function getSelectedHeader() {\n    return () => {\n      const isIndeterminate = intersectionKeys.length > 0 && intersectionKeys.length < canSelectedRows.length;\n      const isChecked =\n        intersectionKeys.length !== 0 &&\n        canSelectedRows.length !== 0 &&\n        intersectionKeys.length === canSelectedRows.length;\n      return (\n        <Checkbox\n          checked={isChecked}\n          indeterminate={isIndeterminate}\n          disabled={!canSelectedRows.length}\n          onChange={handleSelectAll}\n        />\n      );\n    };\n  }\n\n  function renderSelectCell(p: PrimaryTableCellParams<TableRowData>) {\n    const { col: column, row = {}, rowIndex } = p;\n    const checked = tSelectedRowKeys.includes(get(row, rowKey || 'id'));\n    const disabled: boolean =\n      typeof column.disabled === 'function' ? column.disabled({ row, rowIndex }) : column.disabled;\n    const checkProps = isFunction(column.checkProps) ? column.checkProps({ row, rowIndex }) : column.checkProps;\n    const selectBoxProps = {\n      checked,\n      disabled,\n      ...checkProps,\n      onChange: () => {\n        handleSelectChange(row);\n      },\n    };\n    // 选中行功能中，点击 checkbox/radio 需阻止事件冒泡，避免触发不必要的 onRowClick\n    const onCheckClick = (e: MouseEvent<HTMLLabelElement>) => {\n      e?.stopPropagation();\n    };\n    if (column.type === 'single') return <Radio {...selectBoxProps} onClick={onCheckClick} />;\n    if (column.type === 'multiple') {\n      const isIndeterminate = indeterminateSelectedRowKeys?.length\n        ? indeterminateSelectedRowKeys.includes(get(row, rowKey))\n        : false;\n      return <Checkbox indeterminate={isIndeterminate} {...selectBoxProps} onClick={onCheckClick} />;\n    }\n    return null;\n  }\n\n  function handleSelectChange(row: TableRowData = {}) {\n    let selectedRowKeys = [...tSelectedRowKeys];\n    const reRowKey = rowKey || 'id';\n    const id = get(row, reRowKey);\n    const selectedRowIndex = selectedRowKeys.indexOf(id);\n    const isExisted = selectedRowIndex !== -1;\n    if (selectColumn.type === 'multiple') {\n      isExisted ? selectedRowKeys.splice(selectedRowIndex, 1) : selectedRowKeys.push(id);\n    } else if (selectColumn.type === 'single') {\n      selectedRowKeys = !isExisted ? [id] : [];\n    } else {\n      log.warn('Table', '`column.type` must be one of `multiple` and `single`');\n      return;\n    }\n    setTSelectedRowKeys(selectedRowKeys, {\n      selectedRowData: selectedRowKeys.map((t) => selectedRowDataMap.get(t)),\n      currentRowKey: id,\n      currentRowData: row,\n      type: isExisted ? 'uncheck' : 'check',\n    });\n  }\n\n  function handleSelectAll(checked: boolean) {\n    const reRowKey = rowKey || 'id';\n    const canSelectedRowKeys = canSelectedRows.map((record) => get(record, reRowKey));\n    const disabledSelectedRowKeys = selectedRowKeys?.filter((id) => !canSelectedRowKeys.includes(id)) || [];\n    const allIds = checked ? [...disabledSelectedRowKeys, ...canSelectedRowKeys] : [...disabledSelectedRowKeys];\n    setTSelectedRowKeys(allIds, {\n      selectedRowData: checked ? allIds.map((t) => selectedRowDataMap.get(t)) : [],\n      type: checked ? 'check' : 'uncheck',\n      currentRowKey: 'CHECK_ALL_BOX',\n    });\n  }\n\n  function formatToRowSelectColumn(col: PrimaryTableCol) {\n    const isSelection = ['multiple', 'single'].includes(col.type);\n    if (!isSelection) return col;\n    return {\n      ...col,\n      width: col.width || 64,\n      className: tableSelectedClasses.checkCell,\n      cell: (p: PrimaryTableCellParams<TableRowData>) => renderSelectCell(p),\n      title: col.type === 'multiple' ? getSelectedHeader() : col.title,\n    };\n  }\n\n  useEffect(() => {\n    for (let i = 0, len = data.length; i < len; i++) {\n      selectedRowDataMap.set(get(data[i], rowKey || 'id'), data[i]);\n    }\n  }, [data, rowKey]);\n\n  return {\n    selectedRowClassNames,\n    formatToRowSelectColumn,\n  };\n}\n"],"names":["selectedRowDataMap","Map","useRowSelect","props","tableSelectedClasses","selectedRowKeys","columns","data","rowKey","indeterminateSelectedRowKeys","useState","selectedRowClassNames","setSelectedRowClassNames","useControlled","onSelectChange","defaultSelectedRowKeys","tSelectedRowKeys","setTSelectedRowKeys","selectColumn","find","type","includes","canSelectedRows","filter","row","rowIndex","isDisabled","intersectionKeys","intersection","map","t","get","useEffect","length","disabledRowFunc","p","disabled","disabledRowClass","selected","Set","selectedRowClassFunc","rowId","has","selectedRowClass","size","isRowSelectedDisabled","getSelectedHeader","isIndeterminate","isChecked","React","createElement","Checkbox","checked","indeterminate","onChange","handleSelectAll","renderSelectCell","column","col","checkProps","isFunction","selectBoxProps","handleSelectChange","onCheckClick","e","stopPropagation","Radio","onClick","reRowKey","id","selectedRowIndex","indexOf","isExisted","splice","push","log","warn","selectedRowData","currentRowKey","currentRowData","canSelectedRowKeys","record","disabledSelectedRowKeys","allIds","formatToRowSelectColumn","isSelection","width","className","checkCell","cell","title","i","len","set"],"mappings":"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"}