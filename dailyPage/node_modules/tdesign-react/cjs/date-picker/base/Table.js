/**
 * tdesign v0.42.2
 * (c) 2022 tdesign
 * @license MIT
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var defineProperty = require('../../_chunks/dep-3415b40f.js');
var slicedToArray = require('../../_chunks/dep-8c98b84c.js');
var React = require('react');
var classNames = require('classnames');
var locale_LocalReceiver = require('../../locale/LocalReceiver.js');
var hooks_useConfig = require('../../hooks/useConfig.js');
var datePicker_base_Cell = require('./Cell.js');
var _common_js_datePicker_format = require('../../_common/js/date-picker/format.js');
require('../../_chunks/dep-789d4bfb.js');
require('../../config-provider/ConfigContext.js');
require('../../_chunks/dep-bbbce181.js');
require('../../_chunks/dep-4c1144f0.js');
require('../../_chunks/dep-be113066.js');
require('../../_chunks/dep-7affd9c7.js');
require('../../_chunks/dep-c15e2539.js');
require('../../_chunks/dep-1ad27019.js');
require('../../_chunks/dep-6c4c2f3e.js');
require('../../_chunks/dep-b282bced.js');
require('../../_chunks/dep-b8187df5.js');
require('../../_chunks/dep-6b7adfaa.js');
require('../../_chunks/dep-bdb568fa.js');
require('../../_chunks/dep-3c510ebe.js');
require('../../_chunks/dep-ffd983b8.js');
require('../../_chunks/dep-bafabd9b.js');
require('../../_chunks/dep-29ecaf93.js');
require('../../_chunks/dep-28bf72fc.js');
require('../../_chunks/dep-72f2b815.js');
require('../../_chunks/dep-46b250c3.js');
require('../../_chunks/dep-6f0ad8f9.js');
require('../../_chunks/dep-901b688e.js');
require('../../_chunks/dep-92d05577.js');
require('../../_chunks/dep-6aeda844.js');
require('../../_chunks/dep-39147135.js');
require('../../_common/js/global-config/locale/zh_CN.js');
require('../../_common/js/global-config/default-config.js');
require('../../_common/js/date-picker/utils.js');
require('dayjs');
require('../../_chunks/dep-de26ea20.js');
require('../../_chunks/dep-8afae264.js');
require('../../_chunks/dep-f6abffca.js');
require('../../_chunks/dep-6d1aecc8.js');
require('../../_common/js/log/log.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
var classNames__default = /*#__PURE__*/_interopDefaultLegacy(classNames);

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { defineProperty._defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

var DatePickerTable = function DatePickerTable(props) {
  var _useConfig = hooks_useConfig["default"](),
      classPrefix = _useConfig.classPrefix;

  var value = props.value,
      format = props.format,
      mode = props.mode,
      data = props.data,
      time = props.time,
      onCellClick = props.onCellClick,
      onCellMouseEnter = props.onCellMouseEnter,
      onCellMouseLeave = props.onCellMouseLeave,
      firstDayOfWeek = props.firstDayOfWeek;

  var _useLocaleReceiver = locale_LocalReceiver.useLocaleReceiver("datePicker"),
      _useLocaleReceiver2 = slicedToArray._slicedToArray(_useLocaleReceiver, 2),
      local = _useLocaleReceiver2[0],
      t = _useLocaleReceiver2[1];

  var weekdays = t(local.weekdays);
  var weekAbbreviation = t(local.weekAbbreviation);
  var weekArr = [];
  var wi = firstDayOfWeek - 1;
  var len = weekdays.length;

  while (weekArr.length < len) {
    weekArr.push(weekdays[wi]);
    wi = (wi + len + 1) % len;
  }

  if (mode === "week") weekArr.unshift(weekAbbreviation);
  var showThead = mode === "date" || mode === "week";

  var weekRowClass = function weekRowClass(value2, format2, targetValue) {
    if (mode !== "week") return {};

    if (Array.isArray(value2)) {
      var _startObj$year, _startObj$week, _endObj$year, _endObj$week, _ref;

      if (!value2.length) return {};

      var _value2$map = value2.map(function (v) {
        return v && _common_js_datePicker_format.parseToDayjs(v, format2);
      }),
          _value2$map2 = slicedToArray._slicedToArray(_value2$map, 2),
          startObj = _value2$map2[0],
          endObj = _value2$map2[1];

      var startYear = startObj === null || startObj === void 0 ? void 0 : (_startObj$year = startObj.year) === null || _startObj$year === void 0 ? void 0 : _startObj$year.call(startObj);
      var startWeek = startObj === null || startObj === void 0 ? void 0 : (_startObj$week = startObj.week) === null || _startObj$week === void 0 ? void 0 : _startObj$week.call(startObj);
      var endYear = endObj === null || endObj === void 0 ? void 0 : (_endObj$year = endObj.year) === null || _endObj$year === void 0 ? void 0 : _endObj$year.call(endObj);
      var endWeek = endObj === null || endObj === void 0 ? void 0 : (_endObj$week = endObj.week) === null || _endObj$week === void 0 ? void 0 : _endObj$week.call(endObj);
      var targetObj = _common_js_datePicker_format.parseToDayjs(targetValue, format2);
      var targetYear = targetObj.year();
      var targetWeek = targetObj.week();
      var isActive = targetYear === startYear && targetWeek === startWeek || targetYear === endYear && targetWeek === endWeek;
      var isRange = targetYear >= startYear && targetYear <= endYear && targetWeek > startWeek && targetWeek < endWeek;
      return _ref = {}, defineProperty._defineProperty(_ref, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--active"), isActive), defineProperty._defineProperty(_ref, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--range"), isRange), _ref;
    }

    return defineProperty._defineProperty({}, "".concat(classPrefix, "-date-picker__table-").concat(mode, "-row--active"), _common_js_datePicker_format.parseToDayjs(value2, format2).week() === _common_js_datePicker_format.parseToDayjs(targetValue, format2).week());
  };

  return /* @__PURE__ */React__default["default"].createElement("div", {
    className: "".concat(classPrefix, "-date-picker__table"),
    onMouseLeave: function onMouseLeave(e) {
      return onCellMouseLeave === null || onCellMouseLeave === void 0 ? void 0 : onCellMouseLeave({
        e: e
      });
    }
  }, /* @__PURE__ */React__default["default"].createElement("table", null, showThead && /* @__PURE__ */React__default["default"].createElement("thead", null, /* @__PURE__ */React__default["default"].createElement("tr", null, weekArr.map(function (value2, i) {
    return /* @__PURE__ */React__default["default"].createElement("th", {
      key: i
    }, value2);
  }))), /* @__PURE__ */React__default["default"].createElement("tbody", null, data.map(function (row, i) {
    return /* @__PURE__ */React__default["default"].createElement("tr", {
      key: i,
      className: classNames__default["default"]("".concat(classPrefix, "-date-picker__table-").concat(mode, "-row"), _objectSpread({}, weekRowClass(value, format, row[0].value)))
    }, row.map(function (col, j) {
      return /* @__PURE__ */React__default["default"].createElement(datePicker_base_Cell["default"], _objectSpread(_objectSpread({}, col), {}, {
        key: j,
        time: time,
        onClick: onCellClick,
        onMouseEnter: onCellMouseEnter
      }));
    }));
  }))));
};

DatePickerTable.displayName = "DatePickerTable";

exports["default"] = DatePickerTable;
//# sourceMappingURL=Table.js.map
