{"version":3,"file":"FormList.js","sources":["../../src/form/FormList.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useImperativeHandle } from 'react';\nimport merge from 'lodash/merge';\nimport get from 'lodash/get';\nimport { FormListContext, useFormContext } from './FormContext';\nimport { FormItemInstance } from './FormItem';\nimport { TdFormListProps, FormListFieldOperation, FormListField } from './type';\nimport { calcFieldValue } from './utils';\nimport log from '../_common/js/log';\n\nlet key = 0;\n\nconst FormList = (props: TdFormListProps) => {\n  const { formMapRef } = useFormContext();\n  const { name, initialData = [], rules, children } = props;\n\n  const [initialValue, setInitialValue] = useState(initialData);\n  const [fields, setFields] = useState<Array<FormListField>>(\n    initialData.map((data, index) => ({\n      key: (key += 1),\n      name: index,\n      isListField: true,\n      ...data,\n    })),\n  );\n  const formListMapRef = useRef(new Map()); // 收集 formItem 实例\n  const formListRef = useRef<FormItemInstance>(); // 当前 formList 实例\n\n  const operation: FormListFieldOperation = {\n    add(defaultValue?: any, insertIndex?: number) {\n      const cloneFields = [...fields];\n      const index = insertIndex ?? cloneFields.length;\n      cloneFields.splice(index, 0, {\n        key: (key += 1),\n        name: index,\n        isListField: true,\n      });\n      cloneFields.forEach((field, index) => Object.assign(field, { name: index }));\n      setFields(cloneFields);\n\n      if (typeof defaultValue !== 'undefined') {\n        const nextInitialValue = [...initialValue];\n        nextInitialValue[index] = defaultValue;\n        setInitialValue(nextInitialValue);\n      }\n    },\n    remove(index: number | number[]) {\n      const nextFields = fields\n        .filter((_, i) => {\n          if (Array.isArray(index)) return !index.includes(i);\n          return i !== index;\n        })\n        .map((field, index) => Object.assign(field, { name: index }));\n\n      setInitialValue(initialValue.filter((_, idx) => idx !== index));\n      setFields(nextFields);\n    },\n    move(from: number, to: number) {\n      const cloneFields = [...fields];\n      const fromItem = { ...cloneFields[from] };\n      const toItem = { ...cloneFields[to] };\n      cloneFields[to] = fromItem;\n      cloneFields[from] = toItem;\n      setFields(cloneFields);\n    },\n  };\n\n  // 外部设置 fields 优先级最高，可以更改渲染的节点\n  function setListFields(fieldData: any[], callback: Function) {\n    setFields(\n      fieldData.map((_, index) => ({\n        key: (key += 1),\n        name: index,\n        isListField: true,\n      })),\n    );\n    // 延迟至 FormItem 渲染后再赋值\n    requestAnimationFrame(() => {\n      [...formListMapRef.current.values()].forEach((formItemRef) => {\n        const { name } = formItemRef.current;\n        const data = get(fieldData, name);\n        callback(formItemRef, data);\n      });\n    });\n  }\n\n  useEffect(() => {\n    [...formListMapRef.current.values()].forEach((formItemRef) => {\n      const { name, value } = formItemRef.current;\n      if (value) return;\n\n      const data = get(initialValue, name);\n      formItemRef.current.setField({ value: data, status: 'not' });\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fields, initialValue]);\n\n  useEffect(() => {\n    if (!name || !formMapRef) return;\n    formMapRef.current.set(name, formListRef);\n\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      formMapRef.current.delete(name);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [name]);\n\n  useImperativeHandle(\n    formListRef,\n    (): FormItemInstance => ({\n      name,\n      getValue() {\n        const formListValue = [];\n        [...formListMapRef.current.values()].forEach((formItemRef) => {\n          const { name, getValue } = formItemRef.current;\n          const fieldValue = calcFieldValue(name, getValue());\n          merge(formListValue, fieldValue);\n        });\n        return formListValue;\n      },\n      validate: (trigger = 'all') => {\n        const resultList = [];\n        const validates = [...formListMapRef.current.values()].map((formItemRef) =>\n          formItemRef.current.validate(trigger),\n        );\n        return new Promise((resolve) => {\n          Promise.all(validates).then((validateResult) => {\n            validateResult.forEach((result) => {\n              const errorKey = Object.keys(result)[0];\n              const errorKeyList = errorKey.split(',');\n\n              let errorValue = Object.values(result)[0];\n              errorValue = calcFieldValue(errorKeyList, errorValue);\n\n              merge(resultList, errorValue);\n            });\n            const errorItems = validateResult.filter((item) => Object.values(item)[0] !== true);\n            if (errorItems.length) {\n              resolve({ [String(name)]: resultList });\n            } else {\n              resolve({ [String(name)]: true });\n            }\n          });\n        });\n      },\n      setValue: (fieldData: any[]) => {\n        setListFields(fieldData, (formItemRef, data) => {\n          formItemRef?.current?.setValue(data);\n        });\n      },\n      setField: (fieldData: { value?: any[]; status?: string }) => {\n        const { value, status } = fieldData;\n        setListFields(value, (formItemRef, data) => {\n          formItemRef?.current?.setField({ value: data, status });\n        });\n      },\n      resetField: () => {\n        [...formListMapRef.current.values()].forEach((formItemRef) => {\n          formItemRef.current.resetField();\n        });\n        setInitialValue([]);\n      },\n      setValidateMessage: (fieldData) => {\n        [...formListMapRef.current.values()].forEach((formItemRef) => {\n          const { name } = formItemRef.current;\n          const data = get(fieldData, name);\n\n          formItemRef.current.setValidateMessage(data);\n        });\n      },\n      resetValidate: () => {\n        [...formListMapRef.current.values()].forEach((formItemRef) => {\n          formItemRef.current.resetValidate();\n        });\n      },\n    }),\n  );\n\n  if (typeof children !== 'function') {\n    log.error('Form', `FormList's children must be a function!`);\n    return null;\n  }\n\n  return (\n    <FormListContext.Provider value={{ name, rules, formListMapRef }}>\n      {children(fields, operation)}\n    </FormListContext.Provider>\n  );\n};\n\nFormList.displayName = 'FormList';\n\nexport default FormList;\n"],"names":["key","FormList","props","useFormContext","formMapRef","name","initialData","rules","children","useState","initialValue","setInitialValue","map","data","index","isListField","fields","setFields","formListMapRef","useRef","Map","formListRef","operation","add","defaultValue","insertIndex","cloneFields","length","splice","forEach","field","Object","assign","nextInitialValue","remove","nextFields","filter","_","i","Array","isArray","includes","idx","move","from","to","fromItem","toItem","setListFields","fieldData","callback","requestAnimationFrame","current","values","formItemRef","get","useEffect","value","setField","status","set","useImperativeHandle","getValue","formListValue","fieldValue","calcFieldValue","merge","validate","trigger","resultList","validates","Promise","resolve","all","then","validateResult","result","errorKey","keys","errorKeyList","split","errorValue","errorItems","item","String","setValue","resetField","setValidateMessage","resetValidate","log","error","React","createElement","FormListContext","Provider","displayName"],"mappings":"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"}