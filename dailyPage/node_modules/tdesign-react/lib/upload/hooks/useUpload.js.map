{"version":3,"file":"useUpload.js","sources":["../../../src/upload/hooks/useUpload.ts"],"sourcesContent":["import { useRef, useState, useMemo, ChangeEventHandler, DragEvent, MouseEvent, useEffect } from 'react';\nimport merge from 'lodash/merge';\nimport { SizeLimitObj, TdUploadProps, UploadChangeContext, UploadFile, UploadRemoveContext } from '../type';\nimport {\n  getFilesAndErrors,\n  validateFile,\n  upload,\n  getTriggerTextField,\n  getDisplayFiles,\n} from '../../_common/js/upload/main';\nimport { getFileUrlByFileRaw } from '../../_common/js/upload/utils';\nimport useControlled from '../../hooks/useControlled';\nimport { InnerProgressContext, OnResponseErrorContext, SuccessContext } from '../../_common/js/upload/types';\nimport useConfig from '../../hooks/useConfig';\nimport { useLocaleReceiver } from '../../locale/LocalReceiver';\n\n/**\n * 上传组件全部逻辑，方便脱离 UI，自定义 UI 组件\n */\nexport default function useUpload(props: TdUploadProps) {\n  const inputRef = useRef<HTMLInputElement>();\n  // TODO: Form 表单控制上传组件是否禁用\n  const { disabled, autoUpload, isBatchUpload } = props;\n  const { classPrefix } = useConfig();\n  const [globalLocale, t] = useLocaleReceiver('upload');\n  const [uploadValue, setUploadValue] = useControlled(props, 'files', props.onChange);\n  const xhrReq = useRef<{ files: UploadFile[]; xhrReq: XMLHttpRequest }[]>([]);\n  const [toUploadFiles, setToUploadFiles] = useState<UploadFile[]>([]);\n  const [sizeOverLimitMessage, setSizeOverLimitMessage] = useState('');\n\n  const locale = useMemo(() => merge({}, globalLocale, props.locale), [globalLocale, props.locale]);\n\n  const tipsClasses = `${classPrefix}-upload__tips ${classPrefix}-size-s`;\n  const errorClasses = [tipsClasses].concat(`${classPrefix}-upload__tips-error`);\n\n  // 单文件场景：触发元素文本\n  const triggerUploadText = useMemo(() => {\n    const field = getTriggerTextField({\n      isBatchUpload,\n      multiple: props.multiple,\n      status: uploadValue?.[0]?.status,\n      autoUpload,\n    });\n    return locale.triggerUploadText[field];\n  }, [locale.triggerUploadText, uploadValue, props.multiple, isBatchUpload, autoUpload]);\n\n  const [uploading, setUploading] = useState(false);\n\n  // 文件列表显示的内容（自动上传和非自动上传有所不同）\n  const [displayFiles, setDisplayFiles] = useState(uploadValue);\n  useEffect(() => {\n    const files = getDisplayFiles({\n      multiple: props.multiple,\n      toUploadFiles,\n      uploadValue: [...uploadValue],\n      autoUpload,\n      isBatchUpload,\n    });\n    setDisplayFiles(files);\n  }, [props.multiple, toUploadFiles, uploadValue, autoUpload, isBatchUpload]);\n\n  const updateProgress = (\n    p: InnerProgressContext | SuccessContext | OnResponseErrorContext,\n    toFiles: UploadFile[],\n    trigger: 'progress' | 'progress-success' | 'progress-fail',\n  ) => {\n    if (props.autoUpload) {\n      setToUploadFiles([...toFiles]);\n    } else {\n      setUploadValue([...uploadValue], {\n        e: p.event,\n        trigger,\n        index: uploadValue.length,\n        file: p.files[0],\n      });\n    }\n  };\n\n  const onResponseError = (p: OnResponseErrorContext, toFiles?: UploadFile[]) => {\n    if (!p || !p.files || !p.files[0]) return;\n    if (toFiles) {\n      updateProgress(p, toFiles, 'progress-fail');\n    }\n    const { response, event, files } = p;\n    props.onOneFileFail?.({\n      e: event,\n      file: files?.[0],\n      currentFiles: files,\n      failedFiles: files,\n      response,\n    });\n  };\n\n  const onResponseProgress = (p: InnerProgressContext, toFiles: UploadFile[]) => {\n    updateProgress(p, toFiles, 'progress');\n    props.onProgress?.({\n      e: p.event,\n      file: p.file,\n      currentFiles: p.files,\n      percent: p.percent,\n      type: p.type,\n    });\n  };\n\n  // 只有多个上传请求同时触发时才需 onOneFileSuccess\n  const onResponseSuccess = (p: SuccessContext, toFiles: UploadFile[]) => {\n    if (props.multiple && !props.uploadAllFilesInOneRequest) {\n      updateProgress(p, toFiles, 'progress-success');\n      props.onOneFileSuccess?.({\n        e: p.event,\n        file: p.files[0],\n        response: p.response,\n      });\n    }\n  };\n\n  function getSizeLimitError(sizeLimitObj: SizeLimitObj) {\n    const limit = sizeLimitObj;\n    return limit.message\n      ? t(limit.message, { sizeLimit: limit.size })\n      : `${t(locale.sizeLimitMessage, { sizeLimit: limit.size })} ${limit.unit}`;\n  }\n\n  const handleNonAutoUpload = (toFiles: UploadFile[]) => {\n    const tmpFiles = props.multiple && !isBatchUpload ? uploadValue.concat(toFiles) : toFiles;\n    // 图片需要本地预览\n    if (['image', 'image-flow'].includes(props.theme)) {\n      const list = tmpFiles.map(\n        (file) =>\n          new Promise((resolve) => {\n            getFileUrlByFileRaw(file.raw).then((url) => {\n              resolve({ ...file, url });\n            });\n          }),\n      );\n      Promise.all(list).then((files) => {\n        setUploadValue(files, {\n          trigger: 'add',\n          index: uploadValue.length,\n          file: files[0],\n        });\n      });\n    } else {\n      setUploadValue(tmpFiles, {\n        trigger: 'add',\n        index: uploadValue.length,\n        file: tmpFiles[0],\n      });\n    }\n    // toUploadFiles.current = [];\n    setToUploadFiles([]);\n  };\n\n  const onFileChange = (files: FileList) => {\n    if (disabled) return;\n    // @ts-ignore\n    props.onSelectChange?.([...files], { currentSelectedFiles: toUploadFiles });\n    validateFile({\n      uploadValue,\n      // @ts-ignore\n      files: [...files],\n      allowUploadDuplicateFile: props.allowUploadDuplicateFile,\n      max: props.max,\n      sizeLimit: props.sizeLimit,\n      isBatchUpload,\n      autoUpload,\n      format: props.format,\n      beforeUpload: props.beforeUpload,\n      beforeAllFilesUpload: props.beforeAllFilesUpload,\n    }).then((args) => {\n      // 自定义全文件校验不通过\n      if (args.validateResult?.type === 'BEFORE_ALL_FILES_UPLOAD') return;\n      // 文件数量校验不通过\n      if (args.lengthOverLimit) {\n        props.onValidate?.({ type: 'FILES_OVER_LENGTH_LIMIT', files: args.files });\n      }\n      // 过滤相同的文件名\n      if (args.hasSameNameFile) {\n        props.onValidate?.({ type: 'FILTER_FILE_SAME_NAME', files: args.files });\n      }\n      // 文件大小校验结果处理\n      if (args.fileValidateList instanceof Array) {\n        const { sizeLimitErrors, toFiles } = getFilesAndErrors(args.fileValidateList, getSizeLimitError);\n        const tmpWaitingFiles = autoUpload ? toFiles : toUploadFiles.concat(toFiles);\n        props.onWaitingUploadFilesChange?.({ files: tmpWaitingFiles, trigger: 'validate' });\n        // 错误信息处理\n        if (sizeLimitErrors[0]) {\n          setSizeOverLimitMessage(sizeLimitErrors[0].file.response.error);\n          props.onValidate?.({ type: 'FILE_OVER_SIZE_LIMIT', files: sizeLimitErrors.map((t) => t.file) });\n        } else {\n          setSizeOverLimitMessage('');\n        }\n        // 如果是自动上传\n        if (autoUpload) {\n          // toUploadFiles.current = tmpWaitingFiles;\n          setToUploadFiles(tmpWaitingFiles);\n          uploadFiles(tmpWaitingFiles);\n        } else {\n          handleNonAutoUpload(tmpWaitingFiles);\n        }\n      }\n    });\n\n    // 清空 <input type=\"file\"> 元素的文件，避免出现重复文件无法选择的情况\n    inputRef.current.value = null;\n  };\n\n  const onNormalFileChange: ChangeEventHandler<HTMLInputElement> = (e) => {\n    onFileChange?.(e.target.files);\n  };\n\n  function onDragFileChange(e: DragEvent<HTMLDivElement>) {\n    onFileChange?.(e.dataTransfer.files);\n  }\n\n  /**\n   * 上传文件\n   * 对外暴露方法，修改时需谨慎\n   */\n  function uploadFiles(toFiles?: UploadFile[]) {\n    const notUploadedFiles = uploadValue.filter((t) => t.status !== 'success');\n    const files = autoUpload ? toFiles : notUploadedFiles;\n    if (!files || !files.length) return;\n    xhrReq.current = [];\n    setUploading(true);\n    upload({\n      action: props.action,\n      headers: props.headers,\n      withCredentials: props.withCredentials,\n      uploadedFiles: uploadValue,\n      toUploadFiles: files,\n      multiple: props.multiple,\n      isBatchUpload,\n      autoUpload,\n      uploadAllFilesInOneRequest: props.uploadAllFilesInOneRequest,\n      useMockProgress: props.useMockProgress,\n      data: props.data,\n      requestMethod: props.requestMethod,\n      formatRequest: props.formatRequest,\n      formatResponse: props.formatResponse,\n      onResponseProgress: (p) => onResponseProgress(p, toFiles),\n      onResponseSuccess: (p) => onResponseSuccess(p, toFiles),\n      onResponseError: (p) => onResponseError(p, toFiles),\n      setXhrObject: (xhr) => {\n        if (xhr.files[0]?.raw && xhrReq.current.find((item) => item.files[0].raw === xhr.files[0].raw)) return;\n        xhrReq.current = xhrReq.current.concat(xhr);\n      },\n    }).then(\n      ({ status, data, list, failedFiles }) => {\n        setUploading(false);\n        if (status === 'success') {\n          // 全部上传成功后，一次性添加（非自动上传已在上一步添加）\n          if (props.autoUpload) {\n            setUploadValue([...data.files], {\n              trigger: 'add',\n              file: data.files[0],\n            });\n          }\n          props.onSuccess?.({\n            fileList: data.files,\n            currentFiles: files,\n            file: files[0],\n            // 只有全部请求完成后，才会存在该字段\n            results: list?.map((t) => t.data),\n            // 单文件单请求有一个 response，多文件多请求有多个 response\n            response: data.response || list.map((t) => t.data.response),\n          });\n          xhrReq.current = [];\n        } else if (failedFiles?.[0]) {\n          props.onFail?.({\n            e: data.event,\n            file: failedFiles[0],\n            failedFiles,\n            currentFiles: files,\n            response: data.response,\n          });\n        }\n\n        // 非自动上传，文件都在 uploadValue，不涉及 toUploadFiles\n        if (autoUpload) {\n          setToUploadFiles(failedFiles);\n          props.onWaitingUploadFilesChange?.({ files: failedFiles, trigger: 'uploaded' });\n        }\n      },\n      (p) => {\n        onResponseError(p);\n        setUploading(false);\n      },\n    );\n  }\n\n  function onRemove(p: UploadRemoveContext) {\n    setSizeOverLimitMessage('');\n    const changePrams: UploadChangeContext = {\n      e: p.e,\n      trigger: 'remove',\n      index: p.index,\n      file: p.file,\n    };\n    // remove all files for batchUpload\n    if (isBatchUpload || !props.multiple) {\n      props.onWaitingUploadFilesChange?.({ files: [], trigger: 'remove' });\n      setUploadValue([], changePrams);\n      // toUploadFiles.current = [];\n      setToUploadFiles([]);\n      xhrReq.current = [];\n    } else if (!props.autoUpload) {\n      uploadValue.splice(p.index, 1);\n      setUploadValue([...uploadValue], changePrams);\n    } else if (p.index < uploadValue.length) {\n      uploadValue.splice(p.index, 1);\n      setUploadValue([...uploadValue], changePrams);\n    } else {\n      const tmpFiles = [...toUploadFiles];\n      tmpFiles.splice(p.index - uploadValue.length, 1);\n      // toUploadFiles.current = [...tmpFiles];\n      setToUploadFiles([...tmpFiles]);\n      props.onWaitingUploadFilesChange?.({ files: [...tmpFiles], trigger: 'remove' });\n    }\n    props.onRemove?.(p);\n  }\n\n  const triggerUpload = () => {\n    if (disabled) return;\n    (inputRef.current as HTMLInputElement).click();\n  };\n\n  const cancelUpload = (context?: { file?: UploadFile; e?: MouseEvent<HTMLElement> }) => {\n    xhrReq.current?.forEach((item) => {\n      item.xhrReq?.abort();\n    });\n    setUploading(false);\n\n    if (autoUpload) {\n      // toUploadFiles.current = toUploadFiles.current.map((item) => ({ ...item, status: 'waiting' }));\n      setToUploadFiles(toUploadFiles.map((item) => ({ ...item, status: 'waiting' })));\n    } else {\n      setUploadValue(\n        uploadValue.map((item) => {\n          if (item.status !== 'success') {\n            return { ...item, status: 'waiting' };\n          }\n          return item;\n        }),\n        { trigger: 'abort' },\n      );\n    }\n\n    if (context?.file) {\n      onRemove?.({ file: context.file, e: context.e, index: 0 });\n    }\n  };\n\n  return {\n    t,\n    locale,\n    classPrefix,\n    triggerUploadText,\n    toUploadFiles,\n    uploadValue,\n    displayFiles,\n    sizeOverLimitMessage,\n    uploading,\n    tipsClasses,\n    errorClasses,\n    inputRef,\n    disabled,\n    xhrReq,\n    uploadFiles,\n    onFileChange,\n    onNormalFileChange,\n    onDragFileChange,\n    onRemove,\n    triggerUpload,\n    cancelUpload,\n  };\n}\n"],"names":["useUpload","props","inputRef","useRef","disabled","autoUpload","isBatchUpload","useConfig","classPrefix","useLocaleReceiver","globalLocale","t","useControlled","onChange","uploadValue","setUploadValue","xhrReq","useState","toUploadFiles","setToUploadFiles","sizeOverLimitMessage","setSizeOverLimitMessage","locale","useMemo","merge","tipsClasses","errorClasses","concat","triggerUploadText","field","getTriggerTextField","multiple","status","uploading","setUploading","displayFiles","setDisplayFiles","useEffect","files","getDisplayFiles","updateProgress","p","toFiles","trigger","e","event","index","length","file","onResponseError","response","onOneFileFail","currentFiles","failedFiles","onResponseProgress","onProgress","percent","type","onResponseSuccess","uploadAllFilesInOneRequest","onOneFileSuccess","getSizeLimitError","sizeLimitObj","limit","message","sizeLimit","size","sizeLimitMessage","unit","handleNonAutoUpload","tmpFiles","includes","theme","list","map","Promise","resolve","getFileUrlByFileRaw","raw","then","url","all","onFileChange","onSelectChange","currentSelectedFiles","validateFile","allowUploadDuplicateFile","max","format","beforeUpload","beforeAllFilesUpload","args","validateResult","lengthOverLimit","onValidate","hasSameNameFile","fileValidateList","Array","getFilesAndErrors","sizeLimitErrors","tmpWaitingFiles","onWaitingUploadFilesChange","error","uploadFiles","current","value","onNormalFileChange","target","onDragFileChange","dataTransfer","notUploadedFiles","filter","upload","action","headers","withCredentials","uploadedFiles","useMockProgress","data","requestMethod","formatRequest","formatResponse","setXhrObject","xhr","find","item","onSuccess","fileList","results","onFail","onRemove","changePrams","splice","triggerUpload","click","cancelUpload","context","forEach","abort"],"mappings":"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"}